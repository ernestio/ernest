---
repos:
  - name: config-store
    path: git@github.com:ernestio/config-store.git
    branch: master
    volumes:
      - ./config/config-store/:/etc/ernest/
    links:
      - nats
    environment:
      NATS_URI: 'nats://nats:4222'
    entrypoint: /go/bin/config-store -config /etc/ernest/config.json

  - name: api-gateway
    path: git@github.com:ernestio/api-gateway.git
    branch: master
    links:
      - nats
    ports:
      - 8080:8080
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'
      JWT_SECRET: 'GENERATEDJWTSECRET'

  - name: monit
    path: git@github.com:ernestio/monit.git
    branch: master
    links:
      - nats
    ports:
      - 22000:22000
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'
      JWT_SECRET: 'GENERATEDJWTSECRET'

  - name: user-store
    path: git@github.com:ernestio/user-store.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: group-store
    path: git@github.com:ernestio/group-store.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: datacenter-store
    path: git@github.com:ernestio/datacenter-store.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: service-store
    path: git@github.com:ernestio/service-store.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: workflow-manager
    path: git@github.com:ernestio/workflow-manager.git
    branch: master
    links:
      - nats
      - redis
      - postgres
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: definition-mapper
    path: git@github.com:ernestio/definition-mapper.git
    branch: master
    links:
      - nats
      - redis
      - postgres
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: vcloud-definition-mapper
    path: git@github.com:ernestio/vcloud-definition-mapper.git
    branch: master
    links:
      - nats
      - redis
      - postgres
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: aws-definition-mapper
    path: git@github.com:ernestio/aws-definition-mapper.git
    branch: master
    links:
      - nats
      - redis
      - postgres
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: execution-adapter
    path: git@github.com:ernestio/execution-adapter.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: execution-builder
    path: git@github.com:ernestio/execution-builder.git
    branch: master
    links:
      - nats
      - redis
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: all-all-fake-connector
    path: git@github.com:ernestio/all-all-fake-connector.git
    branch: master
    links:
      - nats
      - redis
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: firewall-creator-vcloud-connector
    path: git@github.com:ernestio/firewall-creator-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: firewall-updater-vcloud-connector
    path: git@github.com:ernestio/firewall-updater-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: instance-creator-vcloud-connector
    path: git@github.com:ernestio/instance-creator-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: instance-deleter-vcloud-connector
    path: git@github.com:ernestio/instance-deleter-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: instance-updater-vcloud-connector
    path: git@github.com:ernestio/instance-updater-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: nat-creator-vcloud-connector
    path: git@github.com:ernestio/nat-creator-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: nat-updater-vcloud-connector
    path: git@github.com:ernestio/nat-updater-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: network-creator-vcloud-connector
    path: git@github.com:ernestio/network-creator-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: network-deleter-vcloud-connector
    path: git@github.com:ernestio/network-deleter-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: router-creator-vcloud-connector
    path: git@github.com:ernestio/router-creator-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: router-deleter-vcloud-connector
    path: git@github.com:ernestio/router-deleter-vcloud-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: all-all-aws-connector
    path: git@github.com:ernestio/all-all-aws-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'
      CONNECTORS: nat.create.aws,nat.update.aws,nat.delete.aws,network.create.aws,network.delete.aws,route53.create.aws,route53.delete.aws,route53.update.aws,s3.create.aws,s3.update.aws,s3.delete.aws,elb.create.aws,elb.delete.aws,elb.update.aws,vpc.create.aws,vpc.delete.aws,instance.delete.aws,instance.update.aws,instance.create.aws,firewall.create.aws,firewall.update.aws,firewall.delete.aws,ebs.create.aws,ebs.update.aws,ebs.delete.aws,rds_cluster.create.aws,rds_cluster.update.aws,rds_cluster.delete.aws,rds_instance.create.aws,rds_instance.update.aws,rds_instance.delete.aws

  - name: execution-run-salt-connector
    path: git@github.com:ernestio/execution-run-salt-connector.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: generic-adapter
    path: git@github.com:ernestio/generic-adapter.git
    branch: master
    links:
      - nats
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: generic-builder
    path: git@github.com:ernestio/generic-builder.git
    branch: master
    links:
      - nats
      - redis
    depends:
      - config-store
    environment:
      NATS_URI: 'nats://nats:4222'

  - name: logger
    path: git@github.com:ernestio/logger.git
    branch: master
    links:
      - nats
    environment:
      NATS_URI: 'nats://nats:4222'
      ERNEST_LOG_FILE: '/var/logs/ernest.log'
    volumes:
      - ./logs/:/var/logs/

